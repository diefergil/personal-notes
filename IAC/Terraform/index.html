<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="My personal notes" name="description"/><meta content="Diego" name="author"/><link href="https://diefergil.github.io/personal-notes/IAC/Terraform/" rel="canonical"/><link href="../Pulumi/" rel="prev"/><link href="../../about/" rel="next"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.4.3, mkdocs-material-9.1.20" name="generator"/><title>Terraform - My personal notes</title><link href="../../assets/stylesheets/main.eebd395e.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.ecc896b0.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../css/timeago.css" rel="stylesheet"/><link href="../../stylesheets/extra.css" rel="stylesheet"/><link href="../../stylesheets/links.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-6S6TNHYVRT"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-6S6TNHYVRT",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-6S6TNHYVRT",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script></head> <body data-md-color-accent="light-blue" data-md-color-primary="blue-grey" data-md-color-scheme="default" dir="ltr"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#installation"> Skip to content </a> </div> <div data-md-component="announce"> <aside class="md-banner"> <div class="md-banner__inner md-grid md-typeset"> For updates subscribe to the <a href="https://diefergil.github.io/personal-notes/newsletter/0_newsletter_index/"><strong>RSS feed</strong></a> <img height="15" src="/personal-notes/img/orange_logo.png" width="15"/> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="My personal notes" class="md-header__button md-logo" data-md-component="logo" href="../.." title="My personal notes"> <img alt="logo" src="../../img/logo.bmp"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> My personal notes </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Terraform </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="blue-grey" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue-grey" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/diefergil/personal-notes" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> diefergil/personal-notes </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="My personal notes" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="My personal notes"> <img alt="logo" src="../../img/logo.bmp"/> </a> My personal notes </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/diefergil/personal-notes" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> diefergil/personal-notes </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> Cloud <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Cloud </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2_1" type="checkbox"/> <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0"> AWS <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_2_1"> <span class="md-nav__icon md-icon"></span> AWS </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/aws/app_runner/"> App Runner </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/aws/batch/"> Batch </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/aws/lambda/"> Lambda functions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/aws/steps/"> Steps </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0"> Google Cloud <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_2_2"> <span class="md-nav__icon md-icon"></span> Google Cloud </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/google/gcloud/"> gcloud CLI </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/google/app_engine/"> App Engine </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/google/cloud_functions/"> Cloud Functions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/google/cloud_run/"> Cloud Run </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cloud/google/Bigquery/"> Bigquery </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> Generative AI <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Generative AI </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/introduction/"> Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/nlp/Natural%20Language%20Processing/"> NLP </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0"> Adapting foundational models <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> Adapting foundational models </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/prompting/"> Prompting </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/Fine%20Tuning/"> Instruction Fine-Tuning </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/Reinforcement%20Learning%20From%20Human%20Feedback/"> Reinforcement Learning From Human Feedback </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/probing/"> Probing </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/Evaluate%20LLMs/"> Evaluation </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/Deploy%20LLMS/"> Deployment </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/> <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0"> HuggingFace <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_6"> <span class="md-nav__icon md-icon"></span> HuggingFace </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/huggingface/"> Overview </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/hugginface_intro/"> Hugginface Intro </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/hugging-face-tokenizer/"> Using Hugging Face Tokenizers </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/diffusers/"> Diffusion models and the library from ðŸ¤— </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_7" type="checkbox"/> <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0"> Embeddings <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_7_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_7"> <span class="md-nav__icon md-icon"></span> Embeddings </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/lance_db/"> Vector Database Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/lance_db_multimodal/"> Multimodal Search </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_8" type="checkbox"/> <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0"> Tutorials <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_8_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_8"> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/pytorch_intro/"> Pytorch </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_8_2" type="checkbox"/> <div class="md-nav__link md-nav__link--index"> <a href="../../generative_ai/tutorials/try_promt_techniques/">Promting techninques review</a> <label for="__nav_3_8_2"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="false" aria-labelledby="__nav_3_8_2_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_8_2"> <span class="md-nav__icon md-icon"></span> Promting techninques review </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/Building_QA_Datasets/"> Building Question Answering Datasets </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/wikipedia_qa/"> Wikipedia QA Opean AI example </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/example_ReAcT_prompt/"> React promt example </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/openai_functions/"> Open AI call function </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain_examples/"> Langchain introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_8_6" type="checkbox"/> <label class="md-nav__link" for="__nav_3_8_6" id="__nav_3_8_6_label" tabindex="0"> Transfer Learning <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_8_6_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_8_6"> <span class="md-nav__icon md-icon"></span> Transfer Learning </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/transfer-learning-mobilenet/"> Exercise: Transfer learning using MobileNetV3 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/train_gans/"> Generative Adversarial Network: training </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/training_DDPM/"> Train a Denoising Diffusion Probabilistic Model from scratch </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_8_9" type="checkbox"/> <div class="md-nav__link md-nav__link--index"> <a href="../../generative_ai/tutorials/langchain/snnipets/">Langchain</a> <label for="__nav_3_8_9"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="false" aria-labelledby="__nav_3_8_9_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_8_9"> <span class="md-nav__icon md-icon"></span> Langchain </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/agents/Lesson_2_Student/"> Lesson 2 : LangGraph Components </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/agents/Lesson_4_Student/"> Lesson 4: Persistence and Streaming </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/agents/Lesson_5_Student/"> Lesson 5: Human in the Loop </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/agents/helper/"> Helper </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/functions/L2-lcel-student/"> LangChain Expression Language (LCEL) </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/functions/L5-tools-routing-apis-student/"> Tools and Routing </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../generative_ai/tutorials/langchain/functions/L6-functional_conversation-student/"> Conversational agent </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> Mlops <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Mlops </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../mlops/mlops_intro/"> Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../mlops/continous_delivery/"> Continous integration </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0"> Tools <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../mlops/tools/Docker/"> Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../mlops/tools/github_actions/"> Github actions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../mlops/tools/makefile/"> Makefile </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> Python <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Python </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_1" type="checkbox"/> <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0"> API's <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_1"> <span class="md-nav__icon md-icon"></span> API's </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/apis/best_practices/"> Best practices </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/apis/fastapi/"> FastAPI </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/apis/flask/"> Flask </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/> <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0"> CLI's <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_2"> <span class="md-nav__icon md-icon"></span> CLI's </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/cli/argparse/"> Argparse </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/cli/click/"> Click </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_3" type="checkbox"/> <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0"> Environments <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_3"> <span class="md-nav__icon md-icon"></span> Environments </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/environments/"> Virtual environments </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_4" type="checkbox"/> <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0"> Packaging <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_4"> <span class="md-nav__icon md-icon"></span> Packaging </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/packaging/setuptools/"> Setuptools </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/packaging/Poetry/"> Poetry </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0"> Tests <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_5_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_5"> <span class="md-nav__icon md-icon"></span> Tests </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/pytest/"> Pytests </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> Infrastructure <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../Pulumi/"> Pulumi </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> Terraform <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> Terraform </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#installation"> Installation </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#tools"> Tools </a> <nav aria-label="Tools" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#editor-plugins"> Editor Plugins </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#good-practices-and-maintaining"> Good practices and maintaining </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#tests"> Tests </a> <nav aria-label="Tests" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#static-analysis"> Static analysis </a> <nav aria-label="Static analysis" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#linters"> Linters </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#dry-run"> Dry run </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#unit-tests"> Unit tests </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#e2e-test"> E2E test </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#variables"> Variables </a> <nav aria-label="Variables" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#interpolation-of-variables"> Interpolation of variables </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#show-information-of-the-resources"> Show information of the resources </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#data-source"> Data source </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#read-only-state-source"> Read-only state source </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#template_file-source"> Template_file source </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#resource-lifecycle"> Resource lifecycle </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#use-collaboratively"> Use collaboratively </a> <nav aria-label="Use collaboratively" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#share-state"> Share state </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#lock-terraform"> Lock terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#modules"> Modules </a> <nav aria-label="Modules" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#basics"> Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#outputs"> Outputs </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#import"> Import </a> <nav aria-label="Import" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#bulk-import"> Bulk import </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#bad-points"> Bad points </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#best-practices"> Best practices </a> <nav aria-label="Best practices" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#vpc"> VPC </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-groups"> Security groups </a> <nav aria-label="Security groups" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#default-security-group"> Default security group </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#iam"> IAM </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sensitive-information"> Sensitive information </a> <nav aria-label="Sensitive information" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#sensitive-information-in-the-terraform-state"> Sensitive information in the Terraform State </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sensitive-information-in-the-terraform-source-code"> Sensitive information in the Terraform source code </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rds-credentials"> RDS credentials </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#loops"> Loops </a> <nav aria-label="Loops" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#loop-over-a-variable"> Loop over a variable </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#refactoring"> Refactoring </a> <nav aria-label="Refactoring" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#refactoring-in-modules"> Refactoring in modules </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#refactoring-the-state-file"> Refactoring the state file </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#google-cloud-integration"> Google cloud integration </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#ignore-the-change-of-an-attribute"> Ignore the change of an attribute </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#define-the-default-value-of-an-variable-that-contains-an-object-as-empty"> Define the default value of an variable that contains an object as empty </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#conditionals"> Conditionals </a> <nav aria-label="Conditionals" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#elif"> Elif </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#do-a-conditional-if-a-variable-is-not-null"> Do a conditional if a variable is not null </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#debugging"> Debugging </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#snippets"> Snippets </a> <nav aria-label="Snippets" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#create-a-list-of-resources-based-on-a-list-of-strings"> Create a list of resources based on a list of strings </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#references"> References </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../about/"> About </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#installation"> Installation </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#tools"> Tools </a> <nav aria-label="Tools" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#editor-plugins"> Editor Plugins </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#good-practices-and-maintaining"> Good practices and maintaining </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#tests"> Tests </a> <nav aria-label="Tests" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#static-analysis"> Static analysis </a> <nav aria-label="Static analysis" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#linters"> Linters </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#dry-run"> Dry run </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#unit-tests"> Unit tests </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#e2e-test"> E2E test </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#variables"> Variables </a> <nav aria-label="Variables" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#interpolation-of-variables"> Interpolation of variables </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#show-information-of-the-resources"> Show information of the resources </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#data-source"> Data source </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#read-only-state-source"> Read-only state source </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#template_file-source"> Template_file source </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#resource-lifecycle"> Resource lifecycle </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#use-collaboratively"> Use collaboratively </a> <nav aria-label="Use collaboratively" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#share-state"> Share state </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#lock-terraform"> Lock terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#modules"> Modules </a> <nav aria-label="Modules" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#basics"> Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#outputs"> Outputs </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#import"> Import </a> <nav aria-label="Import" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#bulk-import"> Bulk import </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#bad-points"> Bad points </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#best-practices"> Best practices </a> <nav aria-label="Best practices" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#vpc"> VPC </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-groups"> Security groups </a> <nav aria-label="Security groups" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#default-security-group"> Default security group </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#iam"> IAM </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sensitive-information"> Sensitive information </a> <nav aria-label="Sensitive information" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#sensitive-information-in-the-terraform-state"> Sensitive information in the Terraform State </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sensitive-information-in-the-terraform-source-code"> Sensitive information in the Terraform source code </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rds-credentials"> RDS credentials </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#loops"> Loops </a> <nav aria-label="Loops" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#loop-over-a-variable"> Loop over a variable </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#refactoring"> Refactoring </a> <nav aria-label="Refactoring" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#refactoring-in-modules"> Refactoring in modules </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#refactoring-the-state-file"> Refactoring the state file </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#google-cloud-integration"> Google cloud integration </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#ignore-the-change-of-an-attribute"> Ignore the change of an attribute </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#define-the-default-value-of-an-variable-that-contains-an-object-as-empty"> Define the default value of an variable that contains an object as empty </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#conditionals"> Conditionals </a> <nav aria-label="Conditionals" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#elif"> Elif </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#do-a-conditional-if-a-variable-is-not-null"> Do a conditional if a variable is not null </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#debugging"> Debugging </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#snippets"> Snippets </a> <nav aria-label="Snippets" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#create-a-list-of-resources-based-on-a-list-of-strings"> Create a list of resources based on a list of strings </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#references"> References </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <!-- Google AdSense Code --> <script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4806129530093947"></script> <!-- End Google AdSense Code --> <h1>Terraform</h1> <p><a href="https://en.wikipedia.org/wiki/Terraform_%28software%29">Terraform</a> is an open-source infrastructure as code software tool created by HashiCorp. It enables users to define and provision a datacenter infrastructure using an awful high-level configuration language known as Hashicorp Configuration Language (HCL), or optionally JSON. Terraform supports a number of cloud infrastructure providers such as Amazon Web Services, IBM Cloud , Google Cloud Platform, DigitalOcean, Linode, Microsoft Azure, Oracle Cloud Infrastructure, OVH, or VMware vSphere as well as OpenNebula and OpenStack.</p> <h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">âš‘</a></h2> <p>Go to the <a href="https://github.com/hashicorp/terraform/releases">releases page</a>, download the latest release, decompress it and add it to your <code>$PATH</code>.</p> <h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">âš‘</a></h2> <ul> <li><a href="https://github.com/minamijoyo/tfschema">tfschema</a>: A binary that allows you to see the attributes of the resources of the different providers. There are some times that there are complex attributes that aren't shown on the docs with an example. Here you'll see them clearly.</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>tfschema<span class="w"> </span>resource<span class="w"> </span>list<span class="w"> </span>aws<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>aws_iam_user
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>&gt;<span class="w"> </span>aws_iam_user
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>&gt;<span class="w"> </span>aws_iam_user_group_membership
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>&gt;<span class="w"> </span>aws_iam_user_login_profile
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>&gt;<span class="w"> </span>aws_iam_user_policy
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>&gt;<span class="w"> </span>aws_iam_user_policy_attachment
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>&gt;<span class="w"> </span>aws_iam_user_ssh_key
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>tfschema<span class="w"> </span>resource<span class="w"> </span>show<span class="w"> </span>aws_iam_user
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>+----------------------+-------------+----------+----------+----------+-----------+
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="p">|</span><span class="w"> </span>ATTRIBUTE<span class="w">            </span><span class="p">|</span><span class="w"> </span>TYPE<span class="w">        </span><span class="p">|</span><span class="w"> </span>REQUIRED<span class="w"> </span><span class="p">|</span><span class="w"> </span>OPTIONAL<span class="w"> </span><span class="p">|</span><span class="w"> </span>COMPUTED<span class="w"> </span><span class="p">|</span><span class="w"> </span>SENSITIVE<span class="w"> </span><span class="p">|</span>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>+----------------------+-------------+----------+----------+----------+-----------+
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">|</span><span class="w"> </span>arn<span class="w">                  </span><span class="p">|</span><span class="w"> </span>string<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-14"><a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="p">|</span><span class="w"> </span>force_destroy<span class="w">        </span><span class="p">|</span><span class="w"> </span>bool<span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-15"><a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="p">|</span><span class="w"> </span>id<span class="w">                   </span><span class="p">|</span><span class="w"> </span>string<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-16"><a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="p">|</span><span class="w"> </span>name<span class="w">                 </span><span class="p">|</span><span class="w"> </span>string<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-17"><a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="p">|</span><span class="w"> </span>path<span class="w">                 </span><span class="p">|</span><span class="w"> </span>string<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-18"><a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="p">|</span><span class="w"> </span>permissions_boundary<span class="w"> </span><span class="p">|</span><span class="w"> </span>string<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-19"><a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="p">|</span><span class="w"> </span>tags<span class="w">                 </span><span class="p">|</span><span class="w"> </span>map<span class="o">(</span>string<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-20"><a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="p">|</span><span class="w"> </span>unique_id<span class="w">            </span><span class="p">|</span><span class="w"> </span>string<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">true</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">     </span><span class="p">|</span>
</span><span id="__span-0-21"><a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a>+----------------------+-------------+----------+----------+----------+-----------+
</span><span id="__span-0-22"><a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a>
</span><span id="__span-0-23"><a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="c1"># Open the documentation of the resource in the browser</span>
</span><span id="__span-0-24"><a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a>
</span><span id="__span-0-25"><a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a>tfschema<span class="w"> </span>resource<span class="w"> </span>browse<span class="w"> </span>aws_iam_user
</span></code></pre></div> <ul> <li> <p><a href="https://github.com/dtan4/terraforming">terraforming</a>: Tool to export existing resources to terraform</p> </li> <li> <p><a href="https://github.com/camptocamp/terraboard">terraboard</a>: Web dashboard to visualize and query terraform tfstate, you can search, compare and see the most active ones. There are deployments for k8s.</p> </li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span>XXXXXXXXXXXXXXXXXXXX
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_DEFAULT_REGION</span><span class="o">=</span>eu-west-1
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_BUCKET</span><span class="o">=</span>terraform-tfstate-20180119
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TERRABOARD_LOG_LEVEL</span><span class="o">=</span>debug
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>terranet
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span>--name<span class="w"> </span>db<span class="w"> </span>-e<span class="w"> </span><span class="nv">POSTGRES_USER</span><span class="o">=</span>gorm<span class="w"> </span>-e<span class="w"> </span><span class="nv">POSTGRES_DB</span><span class="o">=</span>gorm<span class="w"> </span>-e<span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span><span class="s2">"mypassword"</span><span class="w"> </span>--net<span class="w"> </span>terranet<span class="w"> </span>postgres
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:8080<span class="w"> </span>-e<span class="w"> </span><span class="nv">AWS_REGION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$AWS_DEFAULT_REGION</span><span class="s2">"</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="si">}</span><span class="s2">"</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="si">}</span><span class="s2">"</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">AWS_BUCKET</span><span class="o">=</span><span class="s2">"</span><span class="nv">$AWS_BUCKET</span><span class="s2">"</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">DB_PASSWORD</span><span class="o">=</span><span class="s2">"mypassword"</span><span class="w"> </span>--net<span class="w"> </span>terranet<span class="w"> </span>camptocamp/terraboard:latest
</span></code></pre></div> <ul> <li>tfenv: Install different versions of terraform</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/tfutils/tfenv.git<span class="w"> </span>~/.tfenv
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">'export PATH="$HOME/.tfenv/bin:$PATH"'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">'export PATH="$HOME/.tfenv/bin:$PATH"'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.zshrc
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>tfenv<span class="w"> </span>list-remote
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>tfenv<span class="w"> </span>install<span class="w"> </span><span class="m">0</span>.12.8
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>terraform<span class="w"> </span>version
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>tfenv<span class="w"> </span>install<span class="w"> </span><span class="m">0</span>.11.15
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>terraform<span class="w"> </span>version
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>tfenv<span class="w"> </span>use<span class="w"> </span><span class="m">0</span>.12.8
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>terraform<span class="w"> </span>version
</span></code></pre></div> <ul> <li> <p><a href="https://github.com/eerkunt/terraform-compliance">https://github.com/eerkunt/terraform-compliance</a></p> </li> <li> <p><a href="https://github.com/coinbase/terraform-landscape">landscape</a>: A program to modify the <code>plan</code> and show a nicer version, really useful when it's shown as json. <a href="https://github.com/coinbase/terraform-landscape/issues/101">Right now</a> it only works for terraform 11.</p> </li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>terraform<span class="w"> </span>plan<span class="w"> </span><span class="p">|</span><span class="w"> </span>landscape
</span></code></pre></div> <ul> <li><a href="https://github.com/sl1pm4t/k2tf">k2tf</a>: Program to convert k8s yaml manifestos to HCL.</li> </ul> <h3 id="editor-plugins">Editor Plugins<a class="headerlink" href="#editor-plugins" title="Permanent link">âš‘</a></h3> <p>For Vim:</p> <ul> <li><a href="https://github.com/hashivim/vim-terraform">vim-terraform</a>: Execute tf from vim and autoformat when saving.</li> <li><a href="https://github.com/juliosueiras/vim-terraform-completion">vim-terraform-completion</a>: linter and autocomplete.</li> </ul> <h3 id="good-practices-and-maintaining">Good practices and maintaining<a class="headerlink" href="#good-practices-and-maintaining" title="Permanent link">âš‘</a></h3> <ul> <li><a href="https://www.terraform.io/docs/commands/fmt.html">fmt</a>: Formats the code following hashicorp best practices.</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>terraform<span class="w"> </span>fmt
</span></code></pre></div> <ul> <li><a href="https://www.terraform.io/docs/commands/validate.html">Validate</a>: Tests that the syntax is correct.</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>terraform<span class="w"> </span>validate
</span></code></pre></div> <ul> <li><a href="https://github.com/segmentio/terraform-docs">DocumentaciÃ³n</a>: Generates a table in markdown with the inputs and outputs.</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>terraform-docs<span class="w"> </span>markdown<span class="w"> </span>table<span class="w"> </span>*.tf<span class="w"> </span>&gt;<span class="w"> </span>README.md
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="c1">## Inputs</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="p">|</span><span class="w"> </span>Name<span class="w"> </span><span class="p">|</span><span class="w"> </span>Description<span class="w"> </span><span class="p">|</span><span class="w"> </span>Type<span class="w"> </span><span class="p">|</span><span class="w"> </span>Default<span class="w"> </span><span class="p">|</span><span class="w"> </span>Required<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="p">|</span>------<span class="p">|</span>-------------<span class="p">|</span>:----:<span class="p">|</span>:-----:<span class="p">|</span>:-----:<span class="p">|</span>
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="p">|</span><span class="w"> </span>broker_numbers<span class="w"> </span><span class="p">|</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>brokers<span class="w"> </span><span class="p">|</span><span class="w"> </span>number<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="sb">`</span><span class="s2">"3"</span><span class="sb">`</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>no<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="p">|</span><span class="w"> </span>broker_size<span class="w"> </span><span class="p">|</span><span class="w"> </span>AWS<span class="w"> </span>instance<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>brokers<span class="w"> </span><span class="p">|</span><span class="w"> </span>string<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="sb">`</span><span class="s2">"kafka.m5.large"</span><span class="sb">`</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>no<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-9"><a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="p">|</span><span class="w"> </span>ebs_size<span class="w"> </span><span class="p">|</span><span class="w"> </span>Size<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>brokers<span class="w"> </span>disks<span class="w"> </span><span class="p">|</span><span class="w"> </span>string<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="sb">`</span><span class="s2">"300"</span><span class="sb">`</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>no<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-10"><a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="p">|</span><span class="w"> </span>kafka_version<span class="w"> </span><span class="p">|</span><span class="w"> </span>Kafka<span class="w"> </span>version<span class="w"> </span><span class="p">|</span><span class="w"> </span>string<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="sb">`</span><span class="s2">"2.1.0"</span><span class="sb">`</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>no<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-11"><a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a>
</span><span id="__span-6-12"><a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="c1">## Outputs</span>
</span><span id="__span-6-13"><a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>
</span><span id="__span-6-14"><a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="p">|</span><span class="w"> </span>Name<span class="w"> </span><span class="p">|</span><span class="w"> </span>Description<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-15"><a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="p">|</span>------<span class="p">|</span>-------------<span class="p">|</span>
</span><span id="__span-6-16"><a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="p">|</span><span class="w"> </span>brokers_masked_endpoints<span class="w"> </span><span class="p">|</span><span class="w"> </span>Zookeeper<span class="w"> </span>masked<span class="w"> </span>endpoints<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-17"><a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="p">|</span><span class="w"> </span>brokers_real_endpoints<span class="w"> </span><span class="p">|</span><span class="w"> </span>Zookeeper<span class="w"> </span>real<span class="w"> </span>endpoints<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-18"><a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="p">|</span><span class="w"> </span>zookeeper_masked_endpoints<span class="w"> </span><span class="p">|</span><span class="w"> </span>Zookeeper<span class="w"> </span>masked<span class="w"> </span>endpoints<span class="w"> </span><span class="p">|</span>
</span><span id="__span-6-19"><a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="p">|</span><span class="w"> </span>zookeeper_real_endpoints<span class="w"> </span><span class="p">|</span><span class="w"> </span>Zookeeper<span class="w"> </span>real<span class="w"> </span>endpoints<span class="w"> </span><span class="p">|</span>
</span></code></pre></div> <ul> <li>Terraform lint (<a href="https://github.com/wata727/tflint">tflint</a>): Only works with some AWS resources. It allows the validation against a third party API. For example:</li> </ul> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="w">  </span><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_instance"</span><span class="w"> </span><span class="nv">"foo"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">    </span><span class="na">ami</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">"ami-0ff8a91507f77f867"</span>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="na">instance_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"t1.2xlarge"</span><span class="c1"> # invalid type!</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">  </span><span class="p">}</span>
</span></code></pre></div> <p>The code is valid, but in AWS there doesn't exist the type <code>t1.2xlarge</code>. This test avoids this kind of issues.</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>wget<span class="w"> </span>https://github.com/wata727/tflint/releases/download/v0.11.1/tflint_darwin_amd64.zip
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>unzip<span class="w"> </span>tflint_darwin_amd64.zip
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>sudo<span class="w"> </span>install<span class="w"> </span>tflint<span class="w"> </span>/usr/local/bin/
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>tflint<span class="w"> </span>-v
</span></code></pre></div> <p>We can automate all the above to be executed before we do a commit using the <a href="https://pre-commit.com/">pre-commit</a> framework.</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>pip<span class="w"> </span>install<span class="w"> </span>pre-commit
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$proyectoConTerraform</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">"""repos:</span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="s2">- repo: git://github.com/antonbabenko/pre-commit-terraform</span>
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="s2">  rev: v1.19.0</span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="s2">  hooks:</span>
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="s2">    - id: terraform_fmt</span>
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="s2">    - id: terraform_validate</span>
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="s2">    - id: terraform_docs</span>
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="s2">    - id: terraform_tflint</span>
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="s2">"""</span><span class="w"> </span>&gt;<span class="w"> </span>.pre-commit-config.yaml
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>pre-commit<span class="w"> </span>install
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>pre-commit<span class="w"> </span>run<span class="w"> </span>terraform_fmt
</span><span id="__span-9-14"><a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>pre-commit<span class="w"> </span>run<span class="w"> </span>terraform_validate<span class="w"> </span>--file<span class="w"> </span>dynamo.tf
</span><span id="__span-9-15"><a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a>pre-commit<span class="w"> </span>run<span class="w"> </span>-a
</span></code></pre></div> <h3 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">âš‘</a></h3> <p><a href="https://www.contino.io/insights/top-3-terraform-testing-strategies-for-ultra-reliable-infrastructure-as-code">Motivation</a></p> <h4 id="static-analysis">Static analysis<a class="headerlink" href="#static-analysis" title="Permanent link">âš‘</a></h4> <h5 id="linters">Linters<a class="headerlink" href="#linters" title="Permanent link">âš‘</a></h5> <ul> <li>conftest</li> <li>tflint</li> <li><code>terraform validate</code></li> </ul> <h5 id="dry-run">Dry run<a class="headerlink" href="#dry-run" title="Permanent link">âš‘</a></h5> <ul> <li><code>terraform plan</code></li> <li>hashicorp sentinel</li> <li>terraform-compliance</li> </ul> <h4 id="unit-tests">Unit tests<a class="headerlink" href="#unit-tests" title="Permanent link">âš‘</a></h4> <p>There is no real unit testing in infrastructure code as you need to deploy it in a real environment</p> <ul> <li> <p><code>terratest</code> (works for k8s and terraform)</p> <p>Some sample code in:</p> <ul> <li>github.com/gruntwork-io/infrastructure-as-code-testing-talk</li> <li>gruntwork.io</li> </ul> </li> </ul> <h4 id="e2e-test">E2E test<a class="headerlink" href="#e2e-test" title="Permanent link">âš‘</a></h4> <ul> <li>Too slow and too brittle to be worth it</li> <li>Use incremental e2e testing</li> </ul> <h2 id="variables"><a href="https://www.terraform.io/intro/getting-started/variables.html">Variables</a><a class="headerlink" href="#variables" title="Permanent link">âš‘</a></h2> <p>It's a good practice to name the resource before the particularization of the resource, so you can search all the elements of that resource, for example, instead of <code>client_cidr</code> and <code>operations_cidr</code> use <code>cidr_operations</code> and <code>cidr_client</code></p> <div class="language-tf highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="err">variable</span><span class="w"> </span><span class="s2">"list_example"</span><span class="p">{</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"An example of a list"</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"list"</span>
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">  </span><span class="na">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span>
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="p">}</span>
</span><span id="__span-10-6"><a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>
</span><span id="__span-10-7"><a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="err">variable</span><span class="w"> </span><span class="s2">"map_example"</span><span class="p">{</span>
</span><span id="__span-10-8"><a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"An example of a dictionary"</span>
</span><span id="__span-10-9"><a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"map"</span>
</span><span id="__span-10-10"><a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">  </span><span class="nb">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-11"><a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">    </span><span class="na">key1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"value1"</span>
</span><span id="__span-10-12"><a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">    </span><span class="na">key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"value2"</span>
</span><span id="__span-10-13"><a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-14"><a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="p">}</span>
</span></code></pre></div> <p>For the use of maps inside maps or lists investigate <code>zipmap</code></p> <p>To access you have to use <code>"${var.list_example}"</code></p> <p>For secret variables we use:</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kr">variable</span><span class="w"> </span><span class="nv">"db_password"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-2"><a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The password for the database"</span>
</span><span id="__span-11-3"><a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="p">}</span>
</span></code></pre></div> <p>Which has no default value, we save that password in our keystore and pass it as environmental variable</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TF_VAR_db_password</span><span class="o">=</span><span class="s2">"{{ your password }}"</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>terragrunt<span class="w"> </span>plan
</span></code></pre></div> <p>As a reminder, Terraform stores all variables in its state file in plain text, including this database password, which is why your terragrunt config should always enable encryption for remote state storage in S3</p> <h3 id="interpolation-of-variables"><a href="https://github.com/hashicorp/terraform/issues/4084">Interpolation of variables</a><a class="headerlink" href="#interpolation-of-variables" title="Permanent link">âš‘</a></h3> <p>You can't interpolate in variables, so instead of</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kr">variable</span><span class="w"> </span><span class="nv">"sistemas_gpg"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sistemas public GPG key for Zena"</span>
</span><span id="__span-13-3"><a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"string"</span>
</span><span id="__span-13-4"><a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">  </span><span class="na">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${file("sistemas_zena.pub")}"</span>
</span><span id="__span-13-5"><a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="p">}</span>
</span></code></pre></div> <p>You have to use locals</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="nb">locals</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">  </span><span class="na">sistemas_gpg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${file("sistemas_zena.pub")}"</span>
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="p">}</span>
</span><span id="__span-14-4"><a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>
</span><span id="__span-14-5"><a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="s2">"${local.sistemas_gpg}"</span>
</span></code></pre></div> <h2 id="show-information-of-the-resources">Show information of the resources<a class="headerlink" href="#show-information-of-the-resources" title="Permanent link">âš‘</a></h2> <p>Get information of the infrastructure. Output variables show up in the console after you run <code>terraform apply</code>, you can also use <code>terraform output [{{ output_name }}]</code> to see the value of a specific output without applying any changes</p> <div class="language-tf highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kr">output</span><span class="w"> </span><span class="nv">"public_ip"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${aws_instance.example.public_ip}"</span>
</span><span id="__span-15-3"><a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="p">}</span>
</span></code></pre></div> <div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>&gt;<span class="w"> </span>terraform<span class="w"> </span>apply
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>aws_security_group.instance:<span class="w"> </span>Refreshing<span class="w"> </span>state...<span class="w"> </span><span class="o">(</span>ID:<span class="w"> </span>sg-db91dba1<span class="o">)</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>aws_instance.example:<span class="w"> </span>Refreshing<span class="w"> </span>state...<span class="w"> </span><span class="o">(</span>ID:<span class="w"> </span>i-61744350<span class="o">)</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>Apply<span class="w"> </span>complete!<span class="w"> </span>Resources:<span class="w"> </span><span class="m">0</span><span class="w"> </span>added,<span class="w"> </span><span class="m">0</span><span class="w"> </span>changed,<span class="w"> </span><span class="m">0</span><span class="w"> </span>destroyed.
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>Outputs:
</span><span id="__span-16-6"><a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="nv">public_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">54</span>.174.13.5
</span></code></pre></div> <h2 id="data-source">Data source<a class="headerlink" href="#data-source" title="Permanent link">âš‘</a></h2> <p>A <em>data source</em> represents a piece of read-only information that is fetched from the provider every time you run Terraform. It does not create anything new</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kr">data</span><span class="w"> </span><span class="nc">"aws_availability_zones"</span><span class="w"> </span><span class="nv">"all"</span><span class="w"> </span><span class="p">{}</span>
</span></code></pre></div> <p>And you reference it with <code>"${data.aws_availability_zones.all.names}"</code></p> <h2 id="read-only-state-source">Read-only state source<a class="headerlink" href="#read-only-state-source" title="Permanent link">âš‘</a></h2> <p>With <code>terraform_remote_state</code> you an fetch the Terraform state file stored by another set of templates in a completely read-only manner.</p> <p>From an app template we can read the info of the ddbb with</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kr">data</span><span class="w"> </span><span class="nc">"terraform_remote_state"</span><span class="w"> </span><span class="nv">"db"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-2"><a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="w">  </span><span class="na">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"s3"</span>
</span><span id="__span-18-3"><a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">  </span><span class="nb">config</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-4"><a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">    </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"(YOUR_BUCKET_NAME)"</span>
</span><span id="__span-18-5"><a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">    </span><span class="na">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stage/data-stores/mysql/terraform.tfstate"</span>
</span><span id="__span-18-6"><a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">    </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-east-1"</span>
</span><span id="__span-18-7"><a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-18-8"><a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="p">}</span>
</span></code></pre></div> <p>And you would access the variables inside the database terraform file with <code>data.terraform_remote_state.db.outputs.port</code></p> <p>To share variables from state, you need to to set them in the <code>outputs.tf</code> file.</p> <h2 id="template_file-source">Template_file source<a class="headerlink" href="#template_file-source" title="Permanent link">âš‘</a></h2> <p>It is used to load templates, it has two parameters, <code>template</code> which is a string and <code>vars</code> which is a map of variables. it has one output attribute called <code>rendered</code>, which is the result of rendering template. For example</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># File: user-data.sh</span>
</span><span id="__span-19-2"><a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="c1">#!/bin/bash</span>
</span><span id="__span-19-3"><a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>index.html<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
</span><span id="__span-19-4"><a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="s">&lt;h1&gt;Hello, World&lt;/h1&gt;</span>
</span><span id="__span-19-5"><a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="s">&lt;p&gt;DB address: ${db_address}&lt;/p&gt;</span>
</span><span id="__span-19-6"><a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="s">&lt;p&gt;DB port: ${db_port}&lt;/p&gt;</span>
</span><span id="__span-19-7"><a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="s">EOF</span>
</span><span id="__span-19-8"><a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a>nohup<span class="w"> </span>busybox<span class="w"> </span>httpd<span class="w"> </span>-f<span class="w"> </span>-p<span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">server_port</span><span class="si">}</span><span class="s2">"</span><span class="w"> </span><span class="p">&amp;</span>
</span></code></pre></div> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="kr">data</span><span class="w"> </span><span class="nc">"template_file"</span><span class="w"> </span><span class="nv">"user_data"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="w">  </span><span class="na">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${file("user-data.sh")}"</span>
</span><span id="__span-20-3"><a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">  </span><span class="nb">vars</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-4"><a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">    </span><span class="na">server_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${var.server_port}"</span>
</span><span id="__span-20-5"><a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">    </span><span class="na">db_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${data.terraform_remote_state.db.address}"</span>
</span><span id="__span-20-6"><a href="#__codelineno-20-6" id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="w">    </span><span class="na">db_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${data.terraform_remote_state.db.port}"</span>
</span><span id="__span-20-7"><a href="#__codelineno-20-7" id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-8"><a href="#__codelineno-20-8" id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="resource-lifecycle">Resource lifecycle<a class="headerlink" href="#resource-lifecycle" title="Permanent link">âš‘</a></h2> <p>The <code>lifecycle</code> parameter is a <em>meta-parameter</em>, it exist on about every resource in Terraform. You can add a <code>lifecycle</code> block to any resource to configure how that resource should be created, updated or destroyed.</p> <p>The available options are:</p> <ul> <li><code>create_before_destroy</code>: Which if set to true will create a replacement resource before destroying hte original resource</li> <li><code>prevent_destroy</code>: If set to true, any attempt to delete that resource (<code>terraform destroy</code>), will fail, to delete it you have to first remove the <code>prevent_destroy</code></li> </ul> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-21-1"><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_launch_configuration"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="w">  </span><span class="na">image_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ami-40d28157"</span>
</span><span id="__span-21-3"><a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="w">  </span><span class="na">instance_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"t2.micro"</span>
</span><span id="__span-21-4"><a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="w">  </span><span class="na">security_groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"${aws_security_group.instance.id}"</span><span class="p">]</span>
</span><span id="__span-21-5"><a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="w">  </span><span class="na">user_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="dl">EOF</span>
</span><span id="__span-21-6"><a href="#__codelineno-21-6" id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="sh">              #!/bin/bash</span>
</span><span id="__span-21-7"><a href="#__codelineno-21-7" id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="sh">              echo "Hello, World" &gt; index.html</span>
</span><span id="__span-21-8"><a href="#__codelineno-21-8" id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="sh">              nohup busybox httpd -f -p "${var.server_port}" &amp;</span>
</span><span id="__span-21-9"><a href="#__codelineno-21-9" id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="dl">              EOF</span>
</span><span id="__span-21-10"><a href="#__codelineno-21-10" id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-11"><a href="#__codelineno-21-11" id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="w">    </span><span class="na">create_before_destroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
</span><span id="__span-21-12"><a href="#__codelineno-21-12" id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-21-13"><a href="#__codelineno-21-13" id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="p">}</span>
</span></code></pre></div> <p>If you set the <code>create_before_destroy</code> on a resource, you also have to set it on every resource that X depends on (if you forget, you'll get errors about cyclical dependencies). In the case of the launch configuration, that means you need to set <code>create_before_destroy</code> to true on the security group:</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-22-1"><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_security_group"</span><span class="w"> </span><span class="nv">"instance"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-2"><a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-instance"</span>
</span><span id="__span-22-3"><a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w">  </span><span class="nb">ingress</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-4"><a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="w">    </span><span class="na">from_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${var.server_port}"</span>
</span><span id="__span-22-5"><a href="#__codelineno-22-5" id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w">    </span><span class="na">to_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${var.server_port}"</span>
</span><span id="__span-22-6"><a href="#__codelineno-22-6" id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="w">    </span><span class="na">protocol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"tcp"</span>
</span><span id="__span-22-7"><a href="#__codelineno-22-7" id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="w">    </span><span class="na">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
</span><span id="__span-22-8"><a href="#__codelineno-22-8" id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-22-9"><a href="#__codelineno-22-9" id="__codelineno-22-9" name="__codelineno-22-9"></a><span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-10"><a href="#__codelineno-22-10" id="__codelineno-22-10" name="__codelineno-22-10"></a><span class="w">    </span><span class="na">create_before_destroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
</span><span id="__span-22-11"><a href="#__codelineno-22-11" id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-22-12"><a href="#__codelineno-22-12" id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="use-collaboratively">Use collaboratively<a class="headerlink" href="#use-collaboratively" title="Permanent link">âš‘</a></h2> <h3 id="share-state">Share state<a class="headerlink" href="#share-state" title="Permanent link">âš‘</a></h3> <p>The best option is to use S3 as bucket of the config.</p> <p>First create it</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-23-1"><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_s3_bucket"</span><span class="w"> </span><span class="nv">"terraform_state"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-up-and-running-state"</span>
</span><span id="__span-23-3"><a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">  </span><span class="nb">versioning</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-4"><a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">    </span><span class="na">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
</span><span id="__span-23-5"><a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-23-6"><a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-7"><a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="w">    </span><span class="na">prevent_destroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
</span><span id="__span-23-8"><a href="#__codelineno-23-8" id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-23-9"><a href="#__codelineno-23-9" id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="p">}</span>
</span></code></pre></div> <p>And then configure terraform</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a>terraform<span class="w"> </span>remote<span class="w"> </span>config<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-2"><a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="w">          </span>-backend<span class="o">=</span>s3<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-3"><a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">          </span>-backend-config<span class="o">=</span><span class="s2">"bucket=(YOUR_BUCKET_NAME)"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-4"><a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">          </span>-backend-config<span class="o">=</span><span class="s2">"key=global/s3/terraform.tfstate"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-5"><a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">          </span>-backend-config<span class="o">=</span><span class="s2">"region=us-east-1"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-6"><a href="#__codelineno-24-6" id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="w">          </span>-backend-config<span class="o">=</span><span class="s2">"encrypt=true"</span>
</span></code></pre></div> <p>In this way terraform will automatically pull the latest state from this bucked and push the latest state after running a command</p> <h3 id="lock-terraform">Lock terraform<a class="headerlink" href="#lock-terraform" title="Permanent link">âš‘</a></h3> <p>To avoid several people running terraform at the same time, we'd use <code>terragrunt</code> a wrapper for terraform that manages remote state for you automatically and provies locking by using DynamoDB (in the free tier)</p> <p>Inside the <code>terraform_config.tf</code> you create the dynamodb table and then configure your <code>s3</code> backend to use it</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-25-1"><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># create a dynamodb table for locking the state file</span>
</span><span id="__span-25-2"><a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_dynamodb_table"</span><span class="w"> </span><span class="nv">"dynamodb-terraform-state-lock"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-3"><a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-state-lock-dynamo"</span>
</span><span id="__span-25-4"><a href="#__codelineno-25-4" id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="w">  </span><span class="na">hash_key</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"LockID"</span>
</span><span id="__span-25-5"><a href="#__codelineno-25-5" id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="w">  </span><span class="na">billing_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PAY_PER_REQUEST"</span>
</span><span id="__span-25-6"><a href="#__codelineno-25-6" id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="w">  </span><span class="nb">attribute</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-7"><a href="#__codelineno-25-7" id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LockID"</span>
</span><span id="__span-25-8"><a href="#__codelineno-25-8" id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="w">    </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"S"</span>
</span><span id="__span-25-9"><a href="#__codelineno-25-9" id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-25-10"><a href="#__codelineno-25-10" id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="p">}</span>
</span><span id="__span-25-11"><a href="#__codelineno-25-11" id="__codelineno-25-11" name="__codelineno-25-11"></a>
</span><span id="__span-25-12"><a href="#__codelineno-25-12" id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="nb">terraform</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-13"><a href="#__codelineno-25-13" id="__codelineno-25-13" name="__codelineno-25-13"></a><span class="w">  </span><span class="kr">backend</span><span class="w"> </span><span class="nv">"s3"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-14"><a href="#__codelineno-25-14" id="__codelineno-25-14" name="__codelineno-25-14"></a><span class="w">    </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"provider-tfstate"</span>
</span><span id="__span-25-15"><a href="#__codelineno-25-15" id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="w">    </span><span class="na">key</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"global/s3/terraform.tfstate"</span>
</span><span id="__span-25-16"><a href="#__codelineno-25-16" id="__codelineno-25-16" name="__codelineno-25-16"></a><span class="w">    </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"eu-west-1"</span>
</span><span id="__span-25-17"><a href="#__codelineno-25-17" id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="w">    </span><span class="na">encrypt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"true"</span>
</span><span id="__span-25-18"><a href="#__codelineno-25-18" id="__codelineno-25-18" name="__codelineno-25-18"></a><span class="w">    </span><span class="na">dynamodb_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"global-s3"</span>
</span><span id="__span-25-19"><a href="#__codelineno-25-19" id="__codelineno-25-19" name="__codelineno-25-19"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-25-20"><a href="#__codelineno-25-20" id="__codelineno-25-20" name="__codelineno-25-20"></a><span class="p">}</span>
</span></code></pre></div> <p>You'll probably need to execute an <code>terraform apply</code> with the <code>dynamodb_table</code> line commented</p> <p>If you want to unforce a lock, execute:</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a>terraform<span class="w"> </span>force-unlock<span class="w"> </span><span class="o">{{</span><span class="w"> </span>unlock_id<span class="w"> </span><span class="o">}}</span>
</span></code></pre></div> <p>You get the <code>unlock_id</code> from an error trying to execute any <code>terraform</code> command</p> <h2 id="modules">Modules<a class="headerlink" href="#modules" title="Permanent link">âš‘</a></h2> <p>In terraform you can put code inside of a <code>module</code> and reuse in multiple places throughout your code.</p> <p>The provider resource should be specified by the user and not in the modules</p> <p>Whenever you add a module to your terraform template or modify its source parameter you need to run a get command before you run <code>plan</code> or <code>apply</code></p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a>terraform<span class="w"> </span>get
</span></code></pre></div> <p>To extract output variables of a module to the parent tf file you should use</p> <p><code>${module.{{module.name}}.{{output_name}}}</code></p> <h3 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">âš‘</a></h3> <p>Any set of Terraform templates in a directory is a module.</p> <p>The good practice is to have a directory called <code>modules</code> in your parent project directory. There you git clone the desired modules. and for example inside <code>pro/services/bastion/main.tf</code> you'd call it with:</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-28-1"><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="kr">provider</span><span class="w"> </span><span class="nv">"aws"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-2"><a href="#__codelineno-28-2" id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"eu-west-1"</span>
</span><span id="__span-28-3"><a href="#__codelineno-28-3" id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="p">}</span>
</span><span id="__span-28-4"><a href="#__codelineno-28-4" id="__codelineno-28-4" name="__codelineno-28-4"></a>
</span><span id="__span-28-5"><a href="#__codelineno-28-5" id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="kr">module</span><span class="w"> </span><span class="nv">"bastion"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-6"><a href="#__codelineno-28-6" id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="w">  </span><span class="na">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"../../../modules/services/bastion/"</span>
</span><span id="__span-28-7"><a href="#__codelineno-28-7" id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="outputs">Outputs<a class="headerlink" href="#outputs" title="Permanent link">âš‘</a></h3> <p>Modules encapsulate their resources. A resource in one module cannot directly depend on resources or attributes in other modules, unless those are exported through outputs. These outputs can be referenced in other places in your configuration, for example:</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-29-1"><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_instance"</span><span class="w"> </span><span class="nv">"client"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-2"><a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="w">  </span><span class="na">ami</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="s2">"ami-408c7f28"</span>
</span><span id="__span-29-3"><a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">  </span><span class="na">instance_type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"t1.micro"</span>
</span><span id="__span-29-4"><a href="#__codelineno-29-4" id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">  </span><span class="na">availability_zone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${module.consul.server_availability_zone}"</span>
</span><span id="__span-29-5"><a href="#__codelineno-29-5" id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="import">Import<a class="headerlink" href="#import" title="Permanent link">âš‘</a></h2> <p>You can import the different parts with <code>terraform import {{resource_type}}.{{resource_name}} {{ resource_id }}</code></p> <p>For examples see the documentation of the desired resource.</p> <h3 id="bulk-import">Bulk import<a class="headerlink" href="#bulk-import" title="Permanent link">âš‘</a></h3> <p>But if you want to bulk import sources, I suggest using <code>terraforming</code>.</p> <h2 id="bad-points">Bad points<a class="headerlink" href="#bad-points" title="Permanent link">âš‘</a></h2> <ul> <li>Manually added resources wont be managed by terraform, therefore you can't use it to enforce as shown in this <a href="https://github.com/hashicorp/terraform/issues/4728">bug</a>.</li> <li>If you modify the LC of an ASG, the instances don't get rolling updated, you have to do it manually.</li> <li>They call the dictionaries <code>map</code>... (/ï¾ŸÐ”ï¾Ÿ)/</li> <li>The conditionals are really ugly. You need to use <code>count</code>.</li> <li>You <a href="https://github.com/hashicorp/hcl/issues/211">can't split long strings</a> xD</li> </ul> <h2 id="best-practices">Best practices<a class="headerlink" href="#best-practices" title="Permanent link">âš‘</a></h2> <p>Name the resources with <code>_</code> instead of <code>-</code> so the editor's completion work :)</p> <h3 id="vpc">VPC<a class="headerlink" href="#vpc" title="Permanent link">âš‘</a></h3> <p>Don't use the default vpc</p> <h3 id="security-groups">Security groups<a class="headerlink" href="#security-groups" title="Permanent link">âš‘</a></h3> <p>Instead of using <code>aws_security_group</code> to define the ingress and egress rules, use it only to create the empty security group and use <code>aws_security_group_rule</code> to add the rules, otherwise you'll get into a cycle loop</p> <p>The sintaxis of an egress security group must be <code>egress_from_{{source}}_to_destination</code>. The sintaxis of an ingress security group must be <code>ingress_to_{{destination}}_from_{{source}}</code></p> <p>Also set the order of the arguments, so they look like the name.</p> <p>For ingress rule:</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-30-1"><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="na">security_group_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span><span id="__span-30-2"><a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="na">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span></code></pre></div> <p>And in egress should look like:</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-31-1"><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="na">security_group_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span><span id="__span-31-2"><a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="na">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span></code></pre></div> <p>Imagine you want to filter the traffic from A -&gt; B, the egress rule from A to B should go besides the ingress rule from B to A.</p> <h4 id="default-security-group">Default security group<a class="headerlink" href="#default-security-group" title="Permanent link">âš‘</a></h4> <p>You can't manage the default security group of an vpc, therefore you have to adopt it and set it to no rules at all with <code>aws_default_security_group</code> resource</p> <h2 id="iam">IAM<a class="headerlink" href="#iam" title="Permanent link">âš‘</a></h2> <p>You have to generate an gpg key and export it in base64</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a>gpg<span class="w"> </span>--export<span class="w"> </span><span class="o">{{</span><span class="w"> </span>gpg_id<span class="w"> </span><span class="o">}}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64
</span></code></pre></div> <p>To see the secrets you have to decrypt it</p> <div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a>terraform<span class="w"> </span>output<span class="w"> </span>secret<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>--decode<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>-d
</span></code></pre></div> <h2 id="sensitive-information"><a href="https://blog.gruntwork.io/a-comprehensive-guide-to-managing-secrets-in-your-terraform-code-1d586955ace1">Sensitive information</a><a class="headerlink" href="#sensitive-information" title="Permanent link">âš‘</a></h2> <p>One of the most common questions we get about using Terraform to manage infrastructure as code is how to handle secrets such as passwords, API keys, and other sensitive data.</p> <p>Your secrets live in two places in a terraform environment:</p> <ul> <li><a href="#sensitive-information-in-the-terraform-state">The Terraform state</a></li> <li><a href="#sensitive-information-in-the-terraform-source-code">The Terraform source code</a>.</li> </ul> <h3 id="sensitive-information-in-the-terraform-state">Sensitive information in the Terraform State<a class="headerlink" href="#sensitive-information-in-the-terraform-state" title="Permanent link">âš‘</a></h3> <p>Every time you deploy infrastructure with Terraform, it stores lots of data about that infrastructure, including all the parameters you passed in, in a state file. By default, this is a terraform.tfstate file that is automatically generated in the folder where you ran terraform apply.</p> <p>That means that the secrets will end up in terraform.tfstate in plain text! This has been an <a href="https://github.com/hashicorp/terraform/issues/516">open issue</a> for more than 6 years now, with no clear plans for a first-class solution. There are some workarounds out there that can scrub secrets from your state files, but these are brittle and likely to break with each new Terraform release, so I donâ€™t recommend them.</p> <p>For the time being, you can:</p> <ul> <li><em>Store Terraform state in a backend that supports encryption</em>: Instead of storing your state in a local <code>terraform.tfstate</code> file, Terraform natively supports a variety of backends, such as S3, GCS, and Azure Blob Storage. Many of these backends support encryption, so that instead of your state files being in plain text, they will always be encrypted, both in transit (e.g., via TLS) and on disk (e.g., via AES-256). Most backends also support collaboration features (e.g., automatically pushing and pulling state; locking), so using a backend is a must-have both from a security and teamwork perspective.</li> <li><em>Strictly control who can access your Terraform backend</em>: Since Terraform state files may contain secrets, youâ€™ll want to carefully control who has access to the backend youâ€™re using to store your state files. For example, if youâ€™re using S3 as a backend, youâ€™ll want to configure an IAM policy that solely grants access to the S3 bucket for production to a small handful of trusted devs (or perhaps solely just the CI server you use to deploy to prod).</li> </ul> <p>There are several approaches here.</p> <p>First rely on the S3 encryption to protect the information in your state file.</p> <p>Second, use <a href="https://www.terraform.io/docs/providers/vault/index.html">Vault provider</a> to protect the state file.</p> <p>Third (but I won't use it) would be to use <a href="https://github.com/opencredo/terrahelp">terrahelp</a></p> <h3 id="sensitive-information-in-the-terraform-source-code">Sensitive information in the Terraform source code<a class="headerlink" href="#sensitive-information-in-the-terraform-source-code" title="Permanent link">âš‘</a></h3> <p>To store secrets in your source code you can:</p> <ul> <li><a href="https://blog.gruntwork.io/a-comprehensive-guide-to-managing-secrets-in-your-terraform-code-1d586955ace1#bebe">Use Secret Stores</a></li> <li><a href="https://blog.gruntwork.io/a-comprehensive-guide-to-managing-secrets-in-your-terraform-code-1d586955ace1#4df5">Use environment variables</a></li> <li><a href="https://blog.gruntwork.io/a-comprehensive-guide-to-managing-secrets-in-your-terraform-code-1d586955ace1#3073">Use encrypted files</a></li> </ul> <p>Using Secret Stores is the best solution, but for that you'd need access and trust in a Secret Store provider which I don't have at the moment (if you want to follow this path check out Hashicorp Vault). Using environment variables is the worst solution because this technique helps you avoid storing secrets in plain text in your code, but it leaves the question of how to actually securely store and manage the secrets unanswered. So in a sense, this technique just kicks the can down the road, whereas the other techniques described later are more prescriptive. Although you could use a password manager such as <code>pass</code>. Using encrypted files is the solution that remains.</p> <p>If you don't want to install a secret store and are used to work with GPG, you can encrypt the secrets, store the cipher text in a file, and checking that file into the version control system. To encrypt some data, such as some secrets in a file, you need an encryption key. This key is itself a secret! This creates a bit of a conundrum: how do you securely store that key? You canâ€™t check the key into version control as plain text, as then thereâ€™s no point of encrypting anything with it. You could encrypt the key with another key, but then you then have to figure out where to store that second key. So youâ€™re back to the â€œkick the can down the road problem,â€ as you still have to find a secure way to store your encryption key. Although you can use external solutions such as AWS KMS or GCP KMS we don't want to store that kind of information on big companies servers. A local and more beautiful way is to rely on PGP to do the encryption.</p> <p>We'll use then <a href="https://github.com/mozilla/sops"><code>sops</code></a> a Mozilla tool for managing secrets that can use PGP behind the scenes. <code>sops</code> can automatically decrypt a file when you open it in your text editor, so you can edit the file in plain text, and when you go to save those files, it automatically encrypts the contents again.</p> <p>Terraform does not yet have native support for decrypting files in the format used by <code>sops</code>. One solution is to install and use the custom provider for sops, <a href="https://github.com/carlpett/terraform-provider-sops"><code>terraform-provider-sops</code></a>. Another option, is to use <a href="https://terragrunt.gruntwork.io/">Terragrunt</a>. To avoid installing more tools, it's better to use the terraform provider.</p> <p>First of all you may need to install <code>sops</code>, you can grab the latest release <a href="https://github.com/mozilla/sops/releases">from their downloads page</a>.</p> <p>Then in your terraform code you need to <a href="https://github.com/carlpett/terraform-provider-sops">select the <code>sops</code> provider</a>:</p> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-34-1"><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="nb">terraform</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-2"><a href="#__codelineno-34-2" id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="w">  </span><span class="nb">required_providers</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-3"><a href="#__codelineno-34-3" id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="w">    </span><span class="nb">sops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-4"><a href="#__codelineno-34-4" id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="w">      </span><span class="na">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"carlpett/sops"</span>
</span><span id="__span-34-5"><a href="#__codelineno-34-5" id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="w">      </span><span class="na">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"~&gt; 0.5"</span>
</span><span id="__span-34-6"><a href="#__codelineno-34-6" id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-7"><a href="#__codelineno-34-7" id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-8"><a href="#__codelineno-34-8" id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="p">}</span>
</span></code></pre></div> <p>Configure <code>sops</code> by defining the gpg keys in a <code>.sops.yaml</code> file at the top of your repository:</p> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-35-1"><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="nn">---</span>
</span><span id="__span-35-2"><a href="#__codelineno-35-2" id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="nt">creation_rules</span><span class="p">:</span>
</span><span id="__span-35-3"><a href="#__codelineno-35-3" id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pgp</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
</span><span id="__span-35-4"><a href="#__codelineno-35-4" id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="w">      </span><span class="no">2829BASDFHWEGWG23WDSLKGL323534J35LKWERQS,</span>
</span><span id="__span-35-5"><a href="#__codelineno-35-5" id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="w">      </span><span class="no">2GEFDBW349YHEDOH2T0GE9RH0NEORIG342RFSLHH</span>
</span></code></pre></div> <p>Then create the secrets file with the command <code>sops secrets.enc.json</code> somewhere in your terraform repository. For example:</p> <div class="language-json highlight"><pre><span></span><code><span id="__span-36-1"><a href="#__codelineno-36-1" id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="p">{</span>
</span><span id="__span-36-2"><a href="#__codelineno-36-2" id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="w">  </span><span class="nt">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">,</span>
</span><span id="__span-36-3"><a href="#__codelineno-36-3" id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="w">  </span><span class="nt">"db"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bar"</span><span class="p">}</span>
</span><span id="__span-36-4"><a href="#__codelineno-36-4" id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="p">}</span>
</span></code></pre></div> <p>You'll be able to use these secrets in your terraform code. For example:</p> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-37-1"><a href="#__codelineno-37-1" id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="kr">data</span><span class="w"> </span><span class="nc">"sops_file"</span><span class="w"> </span><span class="nv">"secrets"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-2"><a href="#__codelineno-37-2" id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="w">  </span><span class="na">source_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"secrets.enc.json"</span>
</span><span id="__span-37-3"><a href="#__codelineno-37-3" id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="p">}</span>
</span><span id="__span-37-4"><a href="#__codelineno-37-4" id="__codelineno-37-4" name="__codelineno-37-4"></a>
</span><span id="__span-37-5"><a href="#__codelineno-37-5" id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="kr">output</span><span class="w"> </span><span class="nv">"root-value-password"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-6"><a href="#__codelineno-37-6" id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="c1">  # Access the password variable from the map</span>
</span><span id="__span-37-7"><a href="#__codelineno-37-7" id="__codelineno-37-7" name="__codelineno-37-7"></a><span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.sops_file.secrets.data</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span>
</span><span id="__span-37-8"><a href="#__codelineno-37-8" id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="p">}</span>
</span><span id="__span-37-9"><a href="#__codelineno-37-9" id="__codelineno-37-9" name="__codelineno-37-9"></a>
</span><span id="__span-37-10"><a href="#__codelineno-37-10" id="__codelineno-37-10" name="__codelineno-37-10"></a><span class="kr">output</span><span class="w"> </span><span class="nv">"mapped-nested-value"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-11"><a href="#__codelineno-37-11" id="__codelineno-37-11" name="__codelineno-37-11"></a><span class="c1">  # Access the password variable that is under db via the terraform map of data</span>
</span><span id="__span-37-12"><a href="#__codelineno-37-12" id="__codelineno-37-12" name="__codelineno-37-12"></a><span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.sops_file.secrets.data</span><span class="p">[</span><span class="s2">"db.password"</span><span class="p">]</span>
</span><span id="__span-37-13"><a href="#__codelineno-37-13" id="__codelineno-37-13" name="__codelineno-37-13"></a><span class="p">}</span>
</span><span id="__span-37-14"><a href="#__codelineno-37-14" id="__codelineno-37-14" name="__codelineno-37-14"></a>
</span><span id="__span-37-15"><a href="#__codelineno-37-15" id="__codelineno-37-15" name="__codelineno-37-15"></a><span class="kr">output</span><span class="w"> </span><span class="nv">"nested-json-value"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-16"><a href="#__codelineno-37-16" id="__codelineno-37-16" name="__codelineno-37-16"></a><span class="c1">  # Access the password variable that is under db via the terraform object</span>
</span><span id="__span-37-17"><a href="#__codelineno-37-17" id="__codelineno-37-17" name="__codelineno-37-17"></a><span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsondecode</span><span class="p">(</span><span class="nv">data.sops_file.secrets.raw</span><span class="p">).</span><span class="nv">db.password</span>
</span><span id="__span-37-18"><a href="#__codelineno-37-18" id="__codelineno-37-18" name="__codelineno-37-18"></a><span class="p">}</span>
</span></code></pre></div> <p>Sops also supports encrypting the entire file when in other formats. Such files can also be used by specifying <code>input_type = "raw"</code>:</p> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-38-1"><a href="#__codelineno-38-1" id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="kr">data</span><span class="w"> </span><span class="nc">"sops_file"</span><span class="w"> </span><span class="nv">"some-file"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-2"><a href="#__codelineno-38-2" id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="w">  </span><span class="na">source_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"secret-data.txt"</span>
</span><span id="__span-38-3"><a href="#__codelineno-38-3" id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="w">  </span><span class="na">input_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"raw"</span>
</span><span id="__span-38-4"><a href="#__codelineno-38-4" id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="p">}</span>
</span><span id="__span-38-5"><a href="#__codelineno-38-5" id="__codelineno-38-5" name="__codelineno-38-5"></a>
</span><span id="__span-38-6"><a href="#__codelineno-38-6" id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="kr">output</span><span class="w"> </span><span class="nv">"do-something"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-7"><a href="#__codelineno-38-7" id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.sops_file.some-file.raw</span>
</span><span id="__span-38-8"><a href="#__codelineno-38-8" id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="rds-credentials">RDS credentials<a class="headerlink" href="#rds-credentials" title="Permanent link">âš‘</a></h3> <p>The RDS credentials are saved in plaintext both in the definition and in the state file, see <a href="https://github.com/hashicorp/terraform/issues/516">this</a> bug for more information. The value of <code>password</code> is not compared against the value of the password in the cloud, so as long as the string in the code and the state file remains the same, it won't try to change it.</p> <p>As a workaround, you can create the RDS with a fake password <code>changeme</code>, and once the resource is created, run an <code>aws</code> command to change it. That way, the value in your code and the state is not the real one, but it won't try to change it.</p> <p>Inspired in <a href="https://gist.github.com/mattupstate/27f2bf26d3712b6b7973">this gist</a> and the <a href="https://www.terraform.io/docs/language/resources/provisioners/local-exec.html"><code>local-exec</code></a> docs, you could do:</p> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-39-1"><a href="#__codelineno-39-1" id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_db_instance"</span><span class="w"> </span><span class="nv">"main"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-2"><a href="#__codelineno-39-2" id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="w">    </span><span class="na">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"postgres"</span>
</span><span id="__span-39-3"><a href="#__codelineno-39-3" id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="w">    </span><span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"changeme"</span>
</span><span id="__span-39-4"><a href="#__codelineno-39-4" id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-39-5"><a href="#__codelineno-39-5" id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="p">}</span>
</span><span id="__span-39-6"><a href="#__codelineno-39-6" id="__codelineno-39-6" name="__codelineno-39-6"></a>
</span><span id="__span-39-7"><a href="#__codelineno-39-7" id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"null_resource"</span><span class="w"> </span><span class="nv">"master_password"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-8"><a href="#__codelineno-39-8" id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="w">    </span><span class="nb">triggers</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-9"><a href="#__codelineno-39-9" id="__codelineno-39-9" name="__codelineno-39-9"></a><span class="w">        </span><span class="na">db_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_db_instance.main.address</span>
</span><span id="__span-39-10"><a href="#__codelineno-39-10" id="__codelineno-39-10" name="__codelineno-39-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-39-11"><a href="#__codelineno-39-11" id="__codelineno-39-11" name="__codelineno-39-11"></a><span class="w">    </span><span class="kr">provisioner</span><span class="w"> </span><span class="nv">"local-exec"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-12"><a href="#__codelineno-39-12" id="__codelineno-39-12" name="__codelineno-39-12"></a><span class="w">        </span><span class="na">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pass generate rds_main_password; aws rds modify-db-instance --db-instance-identifier $INSTANCE --master-user-password $(pass show rds_main_password)"</span>
</span><span id="__span-39-13"><a href="#__codelineno-39-13" id="__codelineno-39-13" name="__codelineno-39-13"></a><span class="w">        </span><span class="nb">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-14"><a href="#__codelineno-39-14" id="__codelineno-39-14" name="__codelineno-39-14"></a><span class="w">            </span><span class="na">INSTANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_db_instance.main.identifier</span>
</span><span id="__span-39-15"><a href="#__codelineno-39-15" id="__codelineno-39-15" name="__codelineno-39-15"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-39-16"><a href="#__codelineno-39-16" id="__codelineno-39-16" name="__codelineno-39-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-39-17"><a href="#__codelineno-39-17" id="__codelineno-39-17" name="__codelineno-39-17"></a><span class="p">}</span>
</span></code></pre></div> <p>Where the password is stored in your <code>pass</code> repository that can be shared with the team.</p> <p>If you're wondering why I added such a long line, well it's because of HCL! as you <a href="https://github.com/hashicorp/hcl/issues/211">can't split long strings</a>, marvelous isn't it? xD</p> <h2 id="loops">Loops<a class="headerlink" href="#loops" title="Permanent link">âš‘</a></h2> <p>You can't use nested lists or dictionaries, see this <a href="https://github.com/hashicorp/terraform/issues/2114">2015 bug</a></p> <h3 id="loop-over-a-variable">Loop over a variable<a class="headerlink" href="#loop-over-a-variable" title="Permanent link">âš‘</a></h3> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-40-1"><a href="#__codelineno-40-1" id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="kr">variable</span><span class="w"> </span><span class="nv">"vpn_egress_tcp_ports"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-2"><a href="#__codelineno-40-2" id="__codelineno-40-2" name="__codelineno-40-2"></a><span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VPN egress tcp ports "</span>
</span><span id="__span-40-3"><a href="#__codelineno-40-3" id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"list"</span>
</span><span id="__span-40-4"><a href="#__codelineno-40-4" id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="w">  </span><span class="na">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="m">51</span><span class="p">,</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="m">4500</span><span class="p">]</span>
</span><span id="__span-40-5"><a href="#__codelineno-40-5" id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="p">}</span>
</span><span id="__span-40-6"><a href="#__codelineno-40-6" id="__codelineno-40-6" name="__codelineno-40-6"></a>
</span><span id="__span-40-7"><a href="#__codelineno-40-7" id="__codelineno-40-7" name="__codelineno-40-7"></a><span class="err">resource</span><span class="w"> </span><span class="s2">"aws_security_group_rule" "ingress_tcp_from_ops_to_vpn_instance"</span><span class="p">{</span>
</span><span id="__span-40-8"><a href="#__codelineno-40-8" id="__codelineno-40-8" name="__codelineno-40-8"></a><span class="w">  </span><span class="na">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${length(var.vpn_egress_tcp_ports)}"</span>
</span><span id="__span-40-9"><a href="#__codelineno-40-9" id="__codelineno-40-9" name="__codelineno-40-9"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ingress"</span>
</span><span id="__span-40-10"><a href="#__codelineno-40-10" id="__codelineno-40-10" name="__codelineno-40-10"></a><span class="w">  </span><span class="na">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"${element(var.vpn_egress_tcp_ports, count.index)}"</span>
</span><span id="__span-40-11"><a href="#__codelineno-40-11" id="__codelineno-40-11" name="__codelineno-40-11"></a><span class="w">  </span><span class="na">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"${element(var.vpn_egress_tcp_ports, count.index)}"</span>
</span><span id="__span-40-12"><a href="#__codelineno-40-12" id="__codelineno-40-12" name="__codelineno-40-12"></a><span class="w">  </span><span class="na">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"tcp"</span>
</span><span id="__span-40-13"><a href="#__codelineno-40-13" id="__codelineno-40-13" name="__codelineno-40-13"></a><span class="w">  </span><span class="na">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"${var.cidr}"</span><span class="p">]</span>
</span><span id="__span-40-14"><a href="#__codelineno-40-14" id="__codelineno-40-14" name="__codelineno-40-14"></a><span class="w">  </span><span class="na">security_group_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${aws_security_group.pro_ins_vpn.id}"</span>
</span><span id="__span-40-15"><a href="#__codelineno-40-15" id="__codelineno-40-15" name="__codelineno-40-15"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="refactoring">Refactoring<a class="headerlink" href="#refactoring" title="Permanent link">âš‘</a></h2> <p>Refactoring in terraform is <strong>ugly business</strong></p> <h3 id="refactoring-in-modules">Refactoring in modules<a class="headerlink" href="#refactoring-in-modules" title="Permanent link">âš‘</a></h3> <p>If you try to refactor your terraform state into modules it will try to destroy and recreate all the elements of the module...</p> <h3 id="refactoring-the-state-file"><a href="https://www.terraform.io/docs/commands/state/mv.html">Refactoring the state file</a><a class="headerlink" href="#refactoring-the-state-file" title="Permanent link">âš‘</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a href="#__codelineno-41-1" id="__codelineno-41-1" name="__codelineno-41-1"></a>terraform<span class="w"> </span>state<span class="w"> </span>mv<span class="w"> </span>-state-out<span class="o">=</span>other.tfstate<span class="w"> </span>module.web<span class="w"> </span>module.web
</span></code></pre></div> <h2 id="google-cloud-integration"><a href="https://www.terraform.io/docs/providers/google/index.html">Google cloud integration</a><a class="headerlink" href="#google-cloud-integration" title="Permanent link">âš‘</a></h2> <p>You configure it in the terraform directory</p> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-42-1"><a href="#__codelineno-42-1" id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="c1">// Configure the Google Cloud provider</span>
</span><span id="__span-42-2"><a href="#__codelineno-42-2" id="__codelineno-42-2" name="__codelineno-42-2"></a><span class="kr">provider</span><span class="w"> </span><span class="nv">"google"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-3"><a href="#__codelineno-42-3" id="__codelineno-42-3" name="__codelineno-42-3"></a><span class="w">  </span><span class="na">credentials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${file("account.json")}"</span>
</span><span id="__span-42-4"><a href="#__codelineno-42-4" id="__codelineno-42-4" name="__codelineno-42-4"></a><span class="w">  </span><span class="na">project</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-gce-project"</span>
</span><span id="__span-42-5"><a href="#__codelineno-42-5" id="__codelineno-42-5" name="__codelineno-42-5"></a><span class="w">  </span><span class="na">region</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span>
</span><span id="__span-42-6"><a href="#__codelineno-42-6" id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="p">}</span>
</span></code></pre></div> <p>To download the json go to the <a href="https://console.developers.google.com/">Google Developers Console</a>. Go to <code>Credentials</code> then <code>Create credentials</code> and finally <code>Service account key</code>.</p> <p>Select <code>Compute engine default service account</code> and select <code>JSON</code> as the key type.</p> <h2 id="ignore-the-change-of-an-attribute"><a href="https://www.terraform.io/docs/language/meta-arguments/lifecycle.html#syntax-and-arguments">Ignore the change of an attribute</a><a class="headerlink" href="#ignore-the-change-of-an-attribute" title="Permanent link">âš‘</a></h2> <p>Sometimes you don't care whether some attributes of a resource change, if that's the case use the <code>lifecycle</code> statement:</p> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-43-1"><a href="#__codelineno-43-1" id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_instance"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-2"><a href="#__codelineno-43-2" id="__codelineno-43-2" name="__codelineno-43-2"></a><span class="c1">  # ...</span>
</span><span id="__span-43-3"><a href="#__codelineno-43-3" id="__codelineno-43-3" name="__codelineno-43-3"></a>
</span><span id="__span-43-4"><a href="#__codelineno-43-4" id="__codelineno-43-4" name="__codelineno-43-4"></a><span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-5"><a href="#__codelineno-43-5" id="__codelineno-43-5" name="__codelineno-43-5"></a><span class="w">    </span><span class="na">ignore_changes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-43-6"><a href="#__codelineno-43-6" id="__codelineno-43-6" name="__codelineno-43-6"></a><span class="c1">      # Ignore changes to tags, e.g. because a management agent</span>
</span><span id="__span-43-7"><a href="#__codelineno-43-7" id="__codelineno-43-7" name="__codelineno-43-7"></a><span class="c1">      # updates these based on some ruleset managed elsewhere.</span>
</span><span id="__span-43-8"><a href="#__codelineno-43-8" id="__codelineno-43-8" name="__codelineno-43-8"></a><span class="w">      </span><span class="err">tags</span><span class="p">,</span>
</span><span id="__span-43-9"><a href="#__codelineno-43-9" id="__codelineno-43-9" name="__codelineno-43-9"></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-43-10"><a href="#__codelineno-43-10" id="__codelineno-43-10" name="__codelineno-43-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-43-11"><a href="#__codelineno-43-11" id="__codelineno-43-11" name="__codelineno-43-11"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="define-the-default-value-of-an-variable-that-contains-an-object-as-empty"><a href="https://github.com/hashicorp/terraform/issues/19898">Define the default value of an variable that contains an object as empty</a><a class="headerlink" href="#define-the-default-value-of-an-variable-that-contains-an-object-as-empty" title="Permanent link">âš‘</a></h2> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-44-1"><a href="#__codelineno-44-1" id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="kr">variable</span><span class="w"> </span><span class="nv">"database"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-2"><a href="#__codelineno-44-2" id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">object</span><span class="p">({</span>
</span><span id="__span-44-3"><a href="#__codelineno-44-3" id="__codelineno-44-3" name="__codelineno-44-3"></a><span class="w">    </span><span class="na">size</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="kt">number</span>
</span><span id="__span-44-4"><a href="#__codelineno-44-4" id="__codelineno-44-4" name="__codelineno-44-4"></a><span class="w">    </span><span class="na">instance_type</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span>
</span><span id="__span-44-5"><a href="#__codelineno-44-5" id="__codelineno-44-5" name="__codelineno-44-5"></a><span class="w">    </span><span class="na">storage_type</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span>
</span><span id="__span-44-6"><a href="#__codelineno-44-6" id="__codelineno-44-6" name="__codelineno-44-6"></a><span class="w">    </span><span class="na">engine</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span>
</span><span id="__span-44-7"><a href="#__codelineno-44-7" id="__codelineno-44-7" name="__codelineno-44-7"></a><span class="w">    </span><span class="na">engine_version</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span>
</span><span id="__span-44-8"><a href="#__codelineno-44-8" id="__codelineno-44-8" name="__codelineno-44-8"></a><span class="w">    </span><span class="na">parameter_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span>
</span><span id="__span-44-9"><a href="#__codelineno-44-9" id="__codelineno-44-9" name="__codelineno-44-9"></a><span class="w">    </span><span class="na">multi_az</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="kt">bool</span>
</span><span id="__span-44-10"><a href="#__codelineno-44-10" id="__codelineno-44-10" name="__codelineno-44-10"></a><span class="w">  </span><span class="p">})</span>
</span><span id="__span-44-11"><a href="#__codelineno-44-11" id="__codelineno-44-11" name="__codelineno-44-11"></a><span class="w">  </span><span class="na">default</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="kt">null</span>
</span></code></pre></div> <h2 id="conditionals">Conditionals<a class="headerlink" href="#conditionals" title="Permanent link">âš‘</a></h2> <h3 id="elif">Elif<a class="headerlink" href="#elif" title="Permanent link">âš‘</a></h3> <div class="language-terraform highlight"><pre><span></span><code><span id="__span-45-1"><a href="#__codelineno-45-1" id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="nb">locals</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-2"><a href="#__codelineno-45-2" id="__codelineno-45-2" name="__codelineno-45-2"></a><span class="w">  </span><span class="na">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"${ condition ? value : (elif-condition ? elif-value : else-value)}"</span>
</span><span id="__span-45-3"><a href="#__codelineno-45-3" id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="do-a-conditional-if-a-variable-is-not-null"><a href="https://stackoverflow.com/questions/53200585/terraform-conditionals-if-variable-does-not-exist">Do a conditional if a variable is not null</a><a class="headerlink" href="#do-a-conditional-if-a-variable-is-not-null" title="Permanent link">âš‘</a></h3> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-46-1"><a href="#__codelineno-46-1" id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_db_instance"</span><span class="w"> </span><span class="nv">"instance"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-2"><a href="#__codelineno-46-2" id="__codelineno-46-2" name="__codelineno-46-2"></a><span class="w">  </span><span class="na">count</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">var.database</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="kt">null</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-46-3"><a href="#__codelineno-46-3" id="__codelineno-46-3" name="__codelineno-46-3"></a><span class="w">  </span><span class="p">...</span>
</span></code></pre></div> <h2 id="debugging"><a href="https://www.terraform.io/docs/internals/debugging.html">Debugging</a><a class="headerlink" href="#debugging" title="Permanent link">âš‘</a></h2> <p>You can set the <code>TF_LOG</code> environmental variable to one of the log levels <code>TRACE</code>, <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code> or <code>ERROR</code> to change the verbosity of the logs.</p> <p>To remove the debug traces run <code>unset TF_LOG</code>.</p> <h2 id="snippets">Snippets<a class="headerlink" href="#snippets" title="Permanent link">âš‘</a></h2> <h3 id="create-a-list-of-resources-based-on-a-list-of-strings"><a href="https://developer.hashicorp.com/terraform/language/meta-arguments/count">Create a list of resources based on a list of strings</a><a class="headerlink" href="#create-a-list-of-resources-based-on-a-list-of-strings" title="Permanent link">âš‘</a></h3> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-47-1"><a href="#__codelineno-47-1" id="__codelineno-47-1" name="__codelineno-47-1"></a><span class="kr">variable</span><span class="w"> </span><span class="nv">"subnet_ids"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-2"><a href="#__codelineno-47-2" id="__codelineno-47-2" name="__codelineno-47-2"></a><span class="w">  </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="kt">string</span><span class="p">)</span>
</span><span id="__span-47-3"><a href="#__codelineno-47-3" id="__codelineno-47-3" name="__codelineno-47-3"></a><span class="p">}</span>
</span><span id="__span-47-4"><a href="#__codelineno-47-4" id="__codelineno-47-4" name="__codelineno-47-4"></a>
</span><span id="__span-47-5"><a href="#__codelineno-47-5" id="__codelineno-47-5" name="__codelineno-47-5"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_instance"</span><span class="w"> </span><span class="nv">"server"</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-6"><a href="#__codelineno-47-6" id="__codelineno-47-6" name="__codelineno-47-6"></a><span class="c1">  # Create one instance for each subnet</span>
</span><span id="__span-47-7"><a href="#__codelineno-47-7" id="__codelineno-47-7" name="__codelineno-47-7"></a><span class="w">  </span><span class="na">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nv">var.subnet_ids</span><span class="p">)</span>
</span><span id="__span-47-8"><a href="#__codelineno-47-8" id="__codelineno-47-8" name="__codelineno-47-8"></a>
</span><span id="__span-47-9"><a href="#__codelineno-47-9" id="__codelineno-47-9" name="__codelineno-47-9"></a><span class="w">  </span><span class="na">ami</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">"ami-a1b2c3d4"</span>
</span><span id="__span-47-10"><a href="#__codelineno-47-10" id="__codelineno-47-10" name="__codelineno-47-10"></a><span class="w">  </span><span class="na">instance_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"t2.micro"</span>
</span><span id="__span-47-11"><a href="#__codelineno-47-11" id="__codelineno-47-11" name="__codelineno-47-11"></a><span class="w">  </span><span class="na">subnet_id</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">var.subnet_ids[count.index</span><span class="p">]</span>
</span><span id="__span-47-12"><a href="#__codelineno-47-12" id="__codelineno-47-12" name="__codelineno-47-12"></a>
</span><span id="__span-47-13"><a href="#__codelineno-47-13" id="__codelineno-47-13" name="__codelineno-47-13"></a><span class="w">  </span><span class="nb">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-14"><a href="#__codelineno-47-14" id="__codelineno-47-14" name="__codelineno-47-14"></a><span class="w">    </span><span class="na">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Server ${count.index}"</span>
</span><span id="__span-47-15"><a href="#__codelineno-47-15" id="__codelineno-47-15" name="__codelineno-47-15"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-47-16"><a href="#__codelineno-47-16" id="__codelineno-47-16" name="__codelineno-47-16"></a><span class="p">}</span>
</span></code></pre></div> <p>If you want to use this generated list on another resource extracting for example the id you can use</p> <div class="language-hcl highlight"><pre><span></span><code><span id="__span-48-1"><a href="#__codelineno-48-1" id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="nv">aws_instance.server</span><span class="p">.</span><span class="err">*</span><span class="p">.</span><span class="err">id</span>
</span></code></pre></div> <h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">âš‘</a></h2> <ul> <li><a href="https://www.terraform.io/docs/index.html">Docs</a></li> <li><a href="https://registry.terraform.io/">Modules registry</a></li> <li><a href="https://github.com/terraform-aws-modules">terraform-aws-modules</a></li> <li><a href="https://www.terraform.io/docs/providers/aws/index.html">AWS providers</a></li> <li><a href="https://github.com/brikis98/terraform-up-and-running-code">AWS examples</a></li> <li><a href="https://github.com/mjuenema/Terraform-Up-and-Running-Code-Samples-Translated/">GCloud examples</a></li> <li><a href="https://charity.wtf/2016/02/23/two-weeks-with-not-by-ai.svg/">Good and bad sides of terraform</a></li> <li><a href="https://github.com/shuaibiyy/awesome-terraform">Awesome Terraform</a> <a href="https://notbyai.fyi">![]{: .center}</a></li> </ul> <hr/> <div class="md-source-file"> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-10-23T19:24:07+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-10-23</span> <br/> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-10-23T19:24:07+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-10-23</span> </small> </div> <form class="md-feedback" hidden="" name="feedback"> <fieldset> <legend class="md-feedback__title"> Was this page helpful? </legend> <div class="md-feedback__inner"> <div class="md-feedback__list"> <button class="md-feedback__icon md-icon" data-md-value="1" title="This page was helpful" type="submit"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 9v12H1V9h4m4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21H9m0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03V19Z"></path></svg> </button> <button class="md-feedback__icon md-icon" data-md-value="0" title="This page could be improved" type="submit"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 15V3h4v12h-4M15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3h9m0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97V5Z"></path></svg> </button> </div> <div class="md-feedback__note"> <div data-md-value="1" hidden=""> Thanks for your feedback! </div> <div data-md-value="0" hidden=""> Thanks for your feedback! Help us improve this page by using our <a href="..." rel="noopener" target="_blank">feedback form</a>. </div> </div> </div> </fieldset> </form> </article> </div> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: Pulumi" class="md-footer__link md-footer__link--prev" href="../Pulumi/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> Pulumi </div> </div> </a> <a aria-label="Next: About" class="md-footer__link md-footer__link--next" href="../../about/" rel="next"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> About </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/diefergil" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </a> <a class="md-social__link" href="https://diefergil.github.io/personal-notes/newsletter/0_newsletter_index" rel="noopener" target="_blank" title="diefergil.github.io"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64zm0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-consent" data-md-component="consent" hidden="" id="__consent"> <div class="md-consent__overlay"></div> <aside class="md-consent__inner"> <form class="md-consent__form md-grid md-typeset" name="consent"> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class="md-toggle" id="__settings" type="checkbox"/> <div class="md-consent__settings"> <ul class="task-list"> <li class="task-list-item"> <label class="task-list-control"> <input checked="" name="analytics" type="checkbox"/> <span class="task-list-indicator"></span> Google Analytics </label> </li> <li class="task-list-item"> <label class="task-list-control"> <input checked="" name="github" type="checkbox"/> <span class="task-list-indicator"></span> GitHub </label> </li> </ul> </div> <div class="md-consent__controls"> <button class="md-button md-button--primary">Accept</button> <label class="md-button" for="__settings">Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script> <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.instant", "navigation.top", "content.code.annotate", "search.suggest", "search.highlight", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script> <script src="../../js/timeago.min.js"></script> <script src="../../js/timeago_mkdocs_material.js"></script> <script src="../../optionalConfig.js"></script> <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script> <script src="../../extra-loader.js"></script> <script src="../../javascripts/mathjax.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> </body> </html>